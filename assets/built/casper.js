!function(s){"use strict";s.fn.fitVids=function(e){var t,i,o={customSelector:null,ignore:null};return document.getElementById("fit-vids-style")||(t=document.head||document.getElementsByTagName("head")[0],(i=document.createElement("div")).innerHTML='<p>x</p><style id="fit-vids-style">.fluid-width-video-container{flex-grow: 1;width:100%;}.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style>',t.appendChild(i.childNodes[1])),e&&s.extend(o,e),this.each(function(){var e=['iframe[src*="player.vimeo.com"]','iframe[src*="youtube.com"]','iframe[src*="youtube-nocookie.com"]','iframe[src*="kickstarter.com"][src*="video.html"]',"object","embed"];o.customSelector&&e.push(o.customSelector);var n=".fitvidsignore";o.ignore&&(n=n+", "+o.ignore);e=s(this).find(e.join(","));(e=(e=e.not("object object")).not(n)).each(function(){var e,t,i=s(this);0<i.parents(n).length||"embed"===this.tagName.toLowerCase()&&i.parent("object").length||i.parent(".fluid-width-video-wrapper").length||(i.css("height")||i.css("width")||!isNaN(i.attr("height"))&&!isNaN(i.attr("width"))||(i.attr("height",9),i.attr("width",16)),e=("object"===this.tagName.toLowerCase()||i.attr("height")&&!isNaN(parseInt(i.attr("height"),10))?parseInt(i.attr("height"),10):i.height())/(isNaN(parseInt(i.attr("width"),10))?i.width():parseInt(i.attr("width"),10)),i.attr("name")||(t="fitvid"+s.fn.fitVids._count,i.attr("name",t),s.fn.fitVids._count++),i.wrap('<div class="fluid-width-video-container"><div class="fluid-width-video-wrapper"></div></div>').parent(".fluid-width-video-wrapper").css("padding-top",100*e+"%"),i.removeAttr("height").removeAttr("width"))})})},s.fn.fitVids._count=0}(window.jQuery||window.Zepto),window.fluidboxGhostConfig={theme:"hsla(0, 0%, 100%, .85)",showCaption:!1},function(e,c){var n,t=e.jQuery||e.Cowboy||(e.Cowboy={});t.throttle=n=function(o,s,a,r){var d,l=0;function e(){var e=this,t=+new Date-l,i=arguments;function n(){l=+new Date,a.apply(e,i)}r&&!d&&n(),d&&clearTimeout(d),r===c&&o<t?n():!0!==s&&(d=setTimeout(r?function(){d=c}:n,r===c?o-t:o))}return"boolean"!=typeof s&&(r=a,a=s,s=c),t.guid&&(e.guid=a.guid=a.guid||t.guid++),e},t.debounce=function(e,t,i){return i===c?n(e,t,!1):n(e,i,!1!==t)}}(this),function(h,e,n,r){"use strict";function o(e,t){this.element=e;var o={};h.each(h(this.element).data(),function(e,t){var i,n=(i=e.replace("fluidbox",""))&&i[0].toLowerCase()+i.slice(1);""===n&&null===n||("false"==t?t=!1:"true"==t&&(t=!0),o[n]=t)}),this.settings=h.extend({},i,t,o),this.settings.viewportFill=Math.max(Math.min(parseFloat(this.settings.viewportFill),1),0),this.settings.stackIndex<this.settings.stackIndexDelta&&(settings.stackIndexDelta=settings.stackIndex),this._name=s,this.init()}var p=h(e),s=(h(n),"fluidbox"),i={immediateOpen:!1,loader:!1,maxWidth:0,maxHeight:0,resizeThrottle:500,stackIndex:1e3,stackIndexDelta:10,viewportFill:.95},g={},a=0;"undefined"!=typeof console&&"undefined"!==console.warn||(console={},console.warn=function(){}),h.isFunction(h.throttle)||console.warn("Fluidbox: The jQuery debounce/throttle plugin is not found/loaded. Even though Fluidbox works without it, the window resize event will fire extremely rapidly in browsers, resulting in significant degradation in performance upon viewport resize.");var d=function(){var e,t=n.createElement("fakeelement"),i={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in i)if(t.style[e]!==r)return i[e]}(),l={dom:function(){var e=h("<div />",{class:"fluidbox__wrap",css:{zIndex:this.settings.stackIndex-this.settings.stackIndexDelta}});h(this.element).addClass("fluidbox--closed").wrapInner(e).find("img").first().css({opacity:1}).addClass("fluidbox__thumb").after('<div class="fluidbox__ghost" />'),this.settings.loader&&(e=h("<div />",{class:"fluidbox__loader",css:{zIndex:2}}),h(this.element).find(".fluidbox__wrap").append(e))},prepareFb:function(){var e=h(this.element);e.trigger("thumbloaddone.fluidbox"),l.measure.fbElements.call(this),this.bindEvents(),e.addClass("fluidbox--ready"),this.bindListeners(),e.trigger("ready.fluidbox")},measure:{viewport:function(){g.viewport={w:p.width(),h:p.height()}},fbElements:function(){var e=h(this.element),t=e.find("img").first(),i=e.find(".fluidbox__ghost"),e=e.find(".fluidbox__wrap");this.instanceData.thumb={natW:t[0].naturalWidth,natH:t[0].naturalHeight,w:t.width(),h:t.height()},i.css({width:t.width(),height:t.height(),top:t.offset().top-e.offset().top+parseInt(t.css("borderTopWidth"))+parseInt(t.css("paddingTop")),left:t.offset().left-e.offset().left+parseInt(t.css("borderLeftWidth"))+parseInt(t.css("paddingLeft"))})}},checkURL:function(e){var t=0;return/[\s+]/g.test(e)?(console.warn("Fluidbox: Fluidbox opening is halted because it has detected characters in your URL string that need to be properly encoded/escaped. Whitespace(s) have to be escaped manually. See RFC3986 documentation."),t=1):/[\"\'\(\)]/g.test(e)&&(console.warn("Fluidbox: Fluidbox opening will proceed, but it has detected characters in your URL string that need to be properly encoded/escaped. These will be escaped for you. See RFC3986 documentation."),t=0),t},formatURL:function(e){return e.replace(/"/g,"%22").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29")}};h.extend(o.prototype,{init:function(){var e,t=this,i=h(this.element),n=i.find("img").first();l.measure.viewport(),t.instanceData&&t.instanceData.initialized||!i.is("a")||1!==i.children().length||!(i.children().is("img")||i.children().is("picture")&&1===i.find("img").length)||"none"===i.css("display")||"none"===i.children().css("display")||"none"===i.parents().css("display")||(i.removeClass("fluidbox--destroyed"),t.instanceData={},t.instanceData.initialized=!0,t.instanceData.originalNode=i.html(),a+=1,t.instanceData.id=a,i.addClass("fluidbox__instance-"+a),i.addClass("fluidbox--initialized"),l.dom.call(t),i.trigger("init.fluidbox"),e=new Image,0<n.width()&&0<n.height()?l.prepareFb.call(t):(e.onload=function(){l.prepareFb.call(t)},e.onerror=function(){i.trigger("thumbloadfail.fluidbox")},e.src=n.attr("src")))},open:function(){var e=this,t=h(this.element),i=t.find("img").first(),n=t.find(".fluidbox__ghost"),o=t.find(".fluidbox__wrap");e.instanceData.state=1,n.off(d),h(".fluidbox--opened").fluidbox("close");var s,a=h("<div />",{class:"fluidbox__overlay",css:{zIndex:-1}});if(o.append(a),t.removeClass("fluidbox--closed").addClass("fluidbox--loading"),l.checkURL(i.attr("src")))return e.close(),!1;n.css({"background-image":"url("+l.formatURL(i.attr("src"))+")",opacity:1}),l.measure.fbElements.call(e),e.settings.immediateOpen?(t.addClass("fluidbox--opened fluidbox--loaded").find(".fluidbox__wrap").css({zIndex:e.settings.stackIndex+e.settings.stackIndexDelta}),t.trigger("openstart.fluidbox"),e.compute(),i.css({opacity:0}),h(".fluidbox__overlay").css({opacity:1}),n.one(d,function(){t.trigger("openend.fluidbox")}),(s=new Image).onload=function(){if(t.trigger("imageloaddone.fluidbox"),1===e.instanceData.state){if(e.instanceData.thumb.natW=s.naturalWidth,e.instanceData.thumb.natH=s.naturalHeight,t.removeClass("fluidbox--loading"),l.checkURL(s.src))return e.close({error:!0}),!1;n.css({"background-image":"url("+l.formatURL(s.src)+")"}),e.compute()}},s.onerror=function(){e.close({error:!0}),t.trigger("imageloadfail.fluidbox"),t.trigger("delayedloadfail.fluidbox")}):((s=new Image).onload=function(){return t.trigger("imageloaddone.fluidbox"),t.removeClass("fluidbox--loading").addClass("fluidbox--opened fluidbox--loaded").find(".fluidbox__wrap").css({zIndex:e.settings.stackIndex+e.settings.stackIndexDelta}),t.trigger("openstart.fluidbox"),l.checkURL(s.src)?(e.close({error:!0}),!1):(n.css({"background-image":"url("+l.formatURL(s.src)+")"}),e.instanceData.thumb.natW=s.naturalWidth,e.instanceData.thumb.natH=s.naturalHeight,e.compute(),i.css({opacity:0}),h(".fluidbox__overlay").css({opacity:1}),void n.one(d,function(){t.trigger("openend.fluidbox")}))},s.onerror=function(){e.close({error:!0}),t.trigger("imageloadfail.fluidbox")}),s.src=t.attr("href")},compute:function(){var e,t=this,i=h(this.element),n=i.find("img").first(),o=i.find(".fluidbox__ghost"),s=i.find(".fluidbox__wrap"),a=t.instanceData.thumb.natW,r=t.instanceData.thumb.natH,d=t.instanceData.thumb.w,l=t.instanceData.thumb.h,c=a/r,u=g.viewport.w/g.viewport.h;0<t.settings.maxWidth?r=(a=t.settings.maxWidth)/c:0<t.settings.maxHeight&&(a=(r=t.settings.maxHeight)*c),a=c<u?(e=a*(l*(f=(r<g.viewport.h?r:g.viewport.h*t.settings.viewportFill)/l)/r)/d,f):(f=r*(d*(e=(a<g.viewport.w?a:g.viewport.w*t.settings.viewportFill)/d)/a)/l,e),t.settings.maxWidth&&t.settings.maxHeight&&console.warn("Fluidbox: Both maxHeight and maxWidth are specified. You can only specify one. If both are specified, only the maxWidth property will be respected. This will not generate any error, but may cause unexpected sizing behavior.");var l=p.scrollTop()-n.offset().top+l*(a-1)*.5+.5*(p.height()-l*a),a=d*(a-1)*.5+.5*(p.width()-d*a)-n.offset().left,f=parseInt(100*e)/100+","+parseInt(100*f)/100;o.css({transform:"translate("+parseInt(100*a)/100+"px,"+parseInt(100*l)/100+"px) scale("+f+")",top:n.offset().top-s.offset().top,left:n.offset().left-s.offset().left}),i.find(".fluidbox__loader").css({transform:"translate("+parseInt(100*a)/100+"px,"+parseInt(100*l)/100+"px) scale("+f+")"}),i.trigger("computeend.fluidbox")},recompute:function(){this.compute()},close:function(e){var t=this,i=h(this.element),n=i.find("img").first(),o=i.find(".fluidbox__ghost"),s=i.find(".fluidbox__wrap"),a=i.find(".fluidbox__overlay"),e=h.extend(null,{error:!1},e);return null!==t.instanceData.state&&typeof t.instanceData.state!=typeof r&&0!==t.instanceData.state&&(t.instanceData.state=0,i.trigger("closestart.fluidbox"),i.removeClass(function(e,t){return(t.match(/(^|\s)fluidbox--(opened|loaded|loading)+/g)||[]).join(" ")}).addClass("fluidbox--closed"),o.css({transform:"translate(0,0) scale(1,1)",top:n.offset().top-s.offset().top+parseInt(n.css("borderTopWidth"))+parseInt(n.css("paddingTop")),left:n.offset().left-s.offset().left+parseInt(n.css("borderLeftWidth"))+parseInt(n.css("paddingLeft"))}),i.find(".fluidbox__loader").css({transform:"none"}),o.one(d,function(){o.css({opacity:0}),n.css({opacity:1}),a.remove(),s.css({zIndex:t.settings.stackIndex-t.settings.stackIndexDelta}),i.trigger("closeend.fluidbox")}),e.error&&o.trigger("transitionend"),void a.css({opacity:0}))},bindEvents:function(){var t=this;h(this.element).on("click.fluidbox",function(e){e.preventDefault(),t.instanceData.state&&0!==t.instanceData.state?t.close():t.open()})},bindListeners:function(){function e(){l.measure.viewport(),l.measure.fbElements.call(t),i.hasClass("fluidbox--opened")&&t.compute()}var t=this,i=h(this.element);h.isFunction(h.throttle)?p.on("resize.fluidbox"+t.instanceData.id,h.throttle(t.settings.resizeThrottle,e)):p.on("resize.fluidbox"+t.instanceData.id,e),i.on("reposition.fluidbox",function(){t.reposition()}),i.on("recompute.fluidbox, compute.fluidbox",function(){t.compute()}),i.on("destroy.fluidbox",function(){t.destroy()}),i.on("close.fluidbox",function(){t.close()})},unbind:function(){h(this.element).off("click.fluidbox reposition.fluidbox recompute.fluidbox compute.fluidbox destroy.fluidbox close.fluidbox"),p.off("resize.fluidbox"+this.instanceData.id)},reposition:function(){l.measure.fbElements.call(this)},destroy:function(){var e=this.instanceData.originalNode;this.unbind(),h.data(this.element,"plugin_"+s,null),h(this.element).removeClass(function(e,t){return(t.match(/(^|\s)fluidbox[--|__]\S+/g)||[]).join(" ")}).empty().html(e).addClass("fluidbox--destroyed").trigger("destroyed.fluidbox")},getMetadata:function(){return this.instanceData}}),h.fn[s]=function(t){var i,n=arguments;return t===r||"object"==typeof t?this.each(function(){h.data(this,"plugin_"+s)||h.data(this,"plugin_"+s,new o(this,t))}):"string"!=typeof t||"_"===t[0]||"init"===t?this:(this.each(function(){var e=h.data(this,"plugin_"+s);e instanceof o&&"function"==typeof e[t]&&(i=e[t].apply(e,Array.prototype.slice.call(n,1)))}),i!==r?i:this)}}(jQuery,window,document),window.fluidboxGhost=$(function(){let e=window.fluidboxGhostConfig.matchImageSelectors||[".kg-gallery-image img",".kg-image-card img",".article-image img"],t;var i=window.fluidboxGhostConfig.theme||"dark";t="image-backdrop"===i?"#212121":"light"===i?"hsla(0, 0%, 100%, .85)":"dark"===i?"hsla(0, 0%, 15%, 0.85)":i,document.styleSheets[0].insertRule(".fluidbox__wrap .fluidbox__overlay{ background-color: "+t+"!important; }",document.styleSheets[0].cssRules.length);var n=window.fluidboxGhostConfig.showCaption;let o=null;$("<div />",{id:"caption-overlay"}).html('<div class="img-caption"></div>').appendTo($("body")),$(e.join(",")).each(function(e,t){$("<a href='"+$(this).attr("src")+"' class='zoom'></a>").insertAfter($(this)),$(this).appendTo($(this).next("a"))}),$(".zoom:not(.fluidbox--opened)").fluidbox({loader:!0,immediateOpen:!0}).on("openstart.fluidbox",function(){var e;"image-backdrop"===i&&(e='background-image: url("'+$(this).find("img").attr("src")+'") !important;',document.styleSheets[0].insertRule(".fluidbox__overlay::before{"+e+"}",document.styleSheets[0].cssRules.length))}).on("openend.fluidbox",function(){var e;o=this,!n||(e=$(this).parents("figure").find("figcaption").html())&&0<e.length&&$("#caption-overlay").addClass("visible").find(".img-caption").text(e)}).on("closestart.fluidbox",function(){o=null,$("#caption-overlay").removeClass("visible")});var s=0;$(window).scroll($.throttle(250,function(){var e=$(window).scrollTop();60<Math.abs(e-s)&&$("a").fluidbox("close"),s=e})),setTimeout(()=>{let i=$(".zoom");window.addEventListener("keydown",function(t){if(o){t.preventDefault(),t.stopImmediatePropagation(),t.stopPropagation();t=t.key;let e=i.index(o);"ArrowRight"===t||"ArrowDown"===t?e++:"ArrowLeft"!==t&&"ArrowUp"!==t||e--,$(i[e]).trigger("click")}})},500)}),function(e){e.addEventListener("DOMContentLoaded",function(){e.querySelectorAll(".kg-gallery-image img").forEach(function(e){var t=e.closest(".kg-gallery-image"),e=e.attributes.width.value/e.attributes.height.value;t.style.flex=e+" 1 0%"})})}((window,document)),function(t,i){var n,o,s,a,r,d,l,c=i.querySelector("link[rel=next]");function u(){if(404===this.status)return t.removeEventListener("scroll",h),void t.removeEventListener("resize",p);this.response.querySelectorAll("article.post-card").forEach(function(e){n.appendChild(i.importNode(e,!0))});var e=this.response.querySelector("link[rel=next]");e?c.href=e.href:(t.removeEventListener("scroll",h),t.removeEventListener("resize",p)),l=i.documentElement.scrollHeight,a=s=!1}function e(){var e;a||(r+d<=l-o?s=!1:(a=!0,(e=new t.XMLHttpRequest).responseType="document",e.addEventListener("load",u),e.open("GET",c.href),e.send(null)))}function f(){s||t.requestAnimationFrame(e),s=!0}function h(){r=t.scrollY,f()}function p(){d=t.innerHeight,l=i.documentElement.scrollHeight,f()}!c||(n=i.querySelector(".post-feed"))&&(a=s=!(o=300),r=t.scrollY,d=t.innerHeight,l=i.documentElement.scrollHeight,t.addEventListener("scroll",h,{passive:!0}),t.addEventListener("resize",p),f())}(window,document);
//# sourceMappingURL=casper.js.map